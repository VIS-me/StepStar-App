<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>StepStar App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        /* –î–æ–±–∞–≤–∏–º –Ω–µ–º–Ω–æ–≥–æ —Å—Ç–∏–ª—è –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∫–∏ –ø—Ä—è–º–æ —Ç—É—Ç */
        .user-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
        }
        #user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid var(--tg-theme-button-color, #248bcf);
            display: none; /* –°–ø—Ä—è—á–µ–º, –ø–æ–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è */
        }
        #user-name {
            margin-top: 10px;
            font-weight: bold;
            font-size: 1.2em;
        }
    </style>
</head>
<body>

    <div class="app-container">
        <div class="user-block">
            <img id="user-avatar" src="" alt="Avatar">
            <div id="user-name"></div>
        </div>

        <div class="steps-box">
            <span id="steps-count">0</span>
            <p id="steps-label">steps today</p>
        </div>

        <button id="share-btn">...</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        // 1. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = tg.initDataUnsafe?.user;
        const userLanguage = user?.language_code || 'en';
        
        // 2. –í—ã–≤–æ–¥–∏–º –∏–º—è –∏ –∞–≤–∞—Ç–∞—Ä–∫—É
        if (user) {
            document.getElementById('user-name').innerText = user.first_name;
            if (user.photo_url) {
                const img = document.getElementById('user-avatar');
                img.src = user.photo_url;
                img.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, –µ—Å–ª–∏ —Ñ–æ—Ç–æ –µ—Å—Ç—å
            }
        }

        // 3. –ü–µ—Ä–µ–≤–æ–¥—ã
        const shareBtn = document.getElementById('share-btn');
        const labelElement = document.getElementById('steps-label');

        const translations = {
            ru: {
                label: "—à–∞–≥–æ–≤ —Å–µ–≥–æ–¥–Ω—è",
                button: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
                shareText: `–Ø –ø—Ä–æ—à–µ–ª 0 —à–∞–≥–æ–≤ –≤ StepStar! üëü`
            },
            en: {
                label: "steps today",
                button: "Share result",
                shareText: `I walked 0 steps in StepStar! üëü`
            }
        };

        const lang = userLanguage === 'ru' ? 'ru' : 'en';
        labelElement.innerText = translations[lang].label;
        shareBtn.innerText = translations[lang].button;

        // 4. –õ–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–∫–∏
        shareBtn.addEventListener('click', () => {
            tg.switchInlineQuery(translations[lang].shareText, ["users", "groups"]);
        });

        tg.setHeaderColor('secondary_bg_color');
    </script>
</body>
</html>
