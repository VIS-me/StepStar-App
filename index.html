<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="app" class="app-viewport"></div>

    <div class="tab-bar">
        <div class="tab-item active" id="tab-home-btn" onclick="navigate('home', this)"><i>ğŸ </i><span id="txt-home"></span></div>
        <div class="tab-item" id="tab-rank-btn" onclick="navigate('rank', this)"><i>ğŸ†</i><span id="txt-rank"></span></div>
        <div class="tab-item" id="tab-tour-btn" onclick="navigate('tour', this)"><i>ğŸ</i><span id="txt-tour"></span></div>
        <div class="tab-item" id="tab-prof-btn" onclick="navigate('prof', this)"><i>ğŸ‘¤</i><span id="txt-prof"></span></div>
    </div>

    <script src="assets.js"></script>
    <script src="pages.js"></script>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        const appLang = (tg.initDataUnsafe?.user?.language_code === 'ru') ? 'ru' : 'en';

        let userState = {
            frame: 'blue',
            steps: 6420
        };

        function updateMenu() {
            document.getElementById('txt-home').innerText = t('home', appLang);
            document.getElementById('txt-rank').innerText = t('rank', appLang);
            document.getElementById('txt-tour').innerText = t('tour', appLang);
            document.getElementById('txt-prof').innerText = t('prof', appLang);
        }

        function navigate(pageId, el) {
            const app = document.getElementById('app');
            const user = tg.initDataUnsafe?.user || { first_name: "Ivan B." };
            
            // Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ¿ĞµÑ€ĞµĞ´Ğ°ĞµĞ¼ appLang Ğ² Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†
            app.innerHTML = Pages[pageId](user, userState, appLang);
            
            if(el) {
                document.querySelectorAll('.tab-item').forEach(i => i.classList.remove('active'));
                el.classList.add('active');
            }
            tg.HapticFeedback.impactOccurred('light');
        }

        function changeFrame(colorName) {
            userState.frame = colorName;
            navigate('prof'); 
            tg.HapticFeedback.notificationOccurred('success');
        }

        window.onload = () => {
            updateMenu(); // ĞŸĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ¸Ğ¼ Ğ¼ĞµĞ½Ñ
            navigate('home'); // Ğ Ğ¸ÑÑƒĞµĞ¼ Ğ³Ğ»Ğ°Ğ²Ğ½ÑƒÑ
        };
    </script>
</body>
</html>
